{% extends "qc/base.html" %}
{% block content %}

<div class="page-title">
  <h1>Frames / Units</h1>
  <div class="actions">
    <a class="btn" href="/frames/template/">Download Frame Template</a>
    <form class="inline" action="/import/frames/" method="post" enctype="multipart/form-data">
      {% csrf_token %}
      <input type="file" name="file" required />
      <button class="btn" type="submit">Upload Frame CSV</button>
    </form>
  </div>
</div>

<form method="get" class="filters">
  <label>Status</label>
  <select name="status">
    <option value="">All</option>
    {% for s in statuses %}
      <option value="{{ s }}" {% if selected.status == s %}selected{% endif %}>{{ s }}</option>
    {% endfor %}
  </select>

  <label>Store</label>
  <select name="store">
    <option value="">All</option>
    {% for st in stores %}
      <option value="{{ st.name }}" {% if selected.store == st.name %}selected{% endif %}>{{ st.name }}</option>
    {% endfor %}
  </select>

  <label>Priority</label>
  <select name="priority">
    <option value="">All</option>
    {% for p in priorities %}
      <option value="{{ p }}" {% if selected.priority == p %}selected{% endif %}>{{ p }}</option>
    {% endfor %}
  </select>

  <button class="btn" type="submit">Filter</button>
</form>

<table class="table">
  <thead>
    <tr>
      <th>Unit</th>
      <th>Order</th>
      <th>Store</th>
      <th>Model</th>
      <th>Lab</th>
      <th>Priority</th>
      <th>Status</th>
      <th>Received</th>
    </tr>
  </thead>
  <tbody>
    {% for u in units %}
      <tr>
        <td><b>{{ u.unit_id }}</b></td>
        <td>{{ u.order_id }}</td>
        <td>{{ u.store.name }}</td>
        <td>{{ u.frame_model.model_name }}</td>
        <td>{{ u.lab.name }}</td>
        <td>{{ u.priority }}</td>
        <td>{{ u.status }}</td>
        <td>{{ u.received_at }}</td>
      </tr>
    {% empty %}
      <tr><td colspan="8" class="muted">No units found.</td></tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
